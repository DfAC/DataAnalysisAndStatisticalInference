---
title: "Data Analysis and Statistical Inference"
#author: "LKB"
output: 
  html_document: 
    highlight: tango
    theme: readable
---

```{r, echo=FALSE}
setwd("d:/tmp/Dropbox/Edu/Coursea/DataAnalysisAndStatisticalInference/")
rm(list=ls(all=TRUE))

library(knitr)
opts_chunk$set(echo = TRUE, cache = FALSE, cache.path = "cache/", fig.path = "figure/", warning = FALSE)
#http://yihui.name/knitr/options/
```


#Introduction
Global warming is an important issue which might affect future generation. Scientific community agrees that the greenhouse effect is responsible for global warming with discussion focused on to what extend the human activity is changing this process [2]. 

Unfortunately over the last decade, this topic has become highly politicized, with strong indication that political lobbing is overtaking rational discussion, leading to polarisation of the opinions. Given that, it is possible that interest in politics (exposure to political pundits, comments and lobbing) can translate to very polarised anty-global warming views. This lead me to my research question:

*"Does interest in politics affects ones views of the global warming."*

Why should we care? Thix question is a proxy for a more complex phenomena - if we can't agree on simple fact, we will fail to establish a dialog leading to discussion and eventual solution.  and understand each other. Indication that politics lead is down this path would be a bad sign indeed.

#Data collection

To answer this question I will be using **American National Elections Study, 2012 Time Series Study Coursera Extract** [1].  I will be looking at following variables:

* INTEREST_ATTENTION answering question *How often do you pay attention to what's going on in government and politics?*
* ENVIR_GWARM answering question *You may have heard about the idea that the world's temperature may have been going up slowly over the past 100 years. What is your personal opinion on this?* 

As discussed in next section, we have a total of 5384 cases - responses from the correspondents (face to face or online). Both variables are categorical. This is the observational study, as correspondents have been surveyed about their current opinion. A random sampling, based on address have been conducted on sample of USA citizens 18 years or older. Data have been collected both in face to face interviews and on-line data collection.

Given that I believe that my findings can be generalised to the population. As study was voluntary, there is possibility of voluntary response bias, showing results more strongly opinionated than general population. To reduce this bias I will limit my analysis to people who answered both parts of the study (pre and post election) - this committment suggest more balance resonse. 

This is observation data, so casual links between the variables of interest can't be established.


#Exploratory data analysis

For further study I will only consider:

* people who responded to both Pre-Election And Post-Election Interviews (I believe this  this committment suggest more balance resonse).
* people who gave answers to both questions (removed 126 not complete cases).

```{r}
load(url("http://bit.ly/dasi_anes_data"))

columns2Keep = c('caseid','interest_attention','envir_gwarm')

anes = anes[anes$wave_completions == 'Yes (Pre-Election And Post-Election Interviews Completed)',columns2Keep]
anes <- anes[complete.cases(anes),] #remove participants with any of data missing
str(anes)
summary(anes) 

```

Overall we have `r length(anes$interest_attention)` cases - responses from the correspondents (face to face or online).

Lets visualise this data.

```{r}
globalWarmingBelievers = table(anes$interest_attention,anes$envir_gwarm)

mosaicplot(globalWarmingBelievers, main ="Do you believe in global warming?", xlab = "Do you pay attention to what's going on in government and politics?",ylab = "Is global warming happening?", color = 3:4)

```

Intial exploration of the data suggest that apart from extreme views (Never/Always) consensus is that global warming has been happening.

What is also interesting to notice is that extreme views on politics are not equal - there is much more people who always follow politics than ones who never follow. Both of thos groups are minority in the society.

#Inference

Following my reserach question *"Does interest in politics influence ones perception regarding the global warming"*, I will state following hipothesis

$H_0:$ Interest in politics does not affect ones views about global warming and proportion of people beliving in global warming is constant across all groups.

$H_A:$ Interest in politics influence ones views about global warming.

To prove my theory I will run $\chi^2$ test of independence, thesing if selected categorical variables are dependent of each other.

##Check conditions

In order to use $\chi^2$ test of independence sample has to be:

* independent - test description indicate that samples (cases) have been random, consist <10% of population and each case is counted only once
* each scenario (interest in politics) nave at least 5 expected cases

##Results

```{r}
source("http://bit.ly/dasi_inference")

inference(y = anes$envir_gwarm, x = anes$interest_attention, est = "proportion", type = "ht",  alternative = "greater", method = "theoretical",eda_plot = FALSE, inf_plot = FALSE )

```

Results indicate that response and explanatory variable are dependent. Following analysis of the data in the previos section I can assume that this is mostly to responses from extreme views (Never/Always) and otherwise citizens behaviour is not affected.

##Do extreme views (Never/Always) skew results?

```{r}
source("http://bit.ly/dasi_inference")

allowedResponses = levels(anes$interest_attention)
allowedResponses = allowedResponses[2:4] #remove extreme responses

nonExtremeCorrespondents = anes[anes$interest_attention %in% allowedResponses,]
nonExtremeCorrespondents$interest_attention = factor(nonExtremeCorrespondents$interest_attention) #remove dropped levels

inference(y = nonExtremeCorrespondents$envir_gwarm, x = nonExtremeCorrespondents$interest_attention, est = "proportion", type = "ht",  alternative = "greater", method = "theoretical",eda_plot = FALSE, inf_plot = FALSE )

USAConsensus= table(nonExtremeCorrespondents$envir_gwarm)/length(nonExtremeCorrespondents$envir_gwarm)
```

Without extreme cases there is no evidence to reject $H_0$ hypothesis.


#Conclusion

In this study we explored the research question *"Does interest in politics influence ones perception regarding the global warming"*. 
Results indicate, that apart from extreme cases American society in general (`r USAConsensus[1]*100`%) believes in global warming. 
This proportion is different for two groups with very strong belies (Always/Never). Interestingly proportion of citizens not believing in global warming is highest in the latest group. Those results indicate that there is no evidence of interest in politics affecting understanding of scientific research.

While groups with very strong belies (Always/Never) are smaller then other ones it would be important to explore them further and understand how those group differ from other people? Are there any other characteristics that set them apart?

Probably most interesting here are citizens who not following politics, despite being much smaller then other groups - it would be important to understand what makes them hold views different to rest of the society. 


#References

[1] American National Election Studies (ANES; www.electionstudies.org). The ANES 2012 Time Series Study [dataset]. Stanford University and the University of Michigan [producers].

Further information about the dataset can be found at <https://d396qusza40orc.cloudfront.net/statistics%2Fproject%2Fanes1.html#envir_gwarm>. Full description of study can be accessed at <http://electionstudies.org/studypages/anes_timeseries_2012/anes_timeseries_2012_userguidecodebook.pdf>

[2] Silver, Nate (2012-09-27). The Signal and the Noise: The Art and Science of Prediction (p. 376). Penguin Books Ltd. Kindle Edition have been used.


#Appendix

Attached is the sample of my final dataset

```{r}
head(anes,40)
```

